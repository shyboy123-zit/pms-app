# 원재료 사용 내역 수정/삭제 기능 추가

## 변경 사항

### 1. DataContext.jsx 업데이트

**새로운 함수 추가:**

#### `updateMaterialUsage(id, oldQuantity, fields)`
- 원재료 사용 내역 수정
- 수량이 변경되면 자동으로 재고 조정
- 예: 50kg → 30kg로 수정하면 재고가 20kg 증가

#### `deleteMaterialUsage(id, materialId, quantity)`
- 원재료 사용 내역 삭제
- 삭제 시 사용했던 수량을 재고에 다시 추가
- 예: 50kg 사용 내역 삭제 → 재고 50kg 증가

**재고 조정 로직:**
- **수정 시**: `새 재고 = 현재 재고 + (기존 사용량 - 새 사용량)`
- **삭제 시**: `새 재고 = 현재 재고 + 사용량`

### 2. Materials.jsx 업데이트

**새로운 State 변수:**
```javascript
const [isEditingUsage, setIsEditingUsage] = useState(false);         // 수정 모드 여부
const [editingUsageId, setEditingUsageId] = useState(null);          // 수정 중인 사용 내역 ID
const [editingUsageOldQuantity, setEditingUsageOldQuantity] = useState(0);  // 기존 수량 (재고 조정용)
```

**새로운 함수:**
- `handleEditUsage(usage)` - 수정 버튼 클릭 시 모달을 수정 모드로 오픈
- `handleDeleteUsage(usage)` - 삭제 확인 후 사용 내역 삭제
- `resetUsageForm()` - 모달 닫고 상태 초기화

**UI 개선:**
- 사용 내역 테이블에 "작업" 컬럼 추가
- 각 행에 수정(Edit)/삭제(Trash2) 아이콘 버튼 추가
- 모달 제목이 모드에 따라 변경: "원재료 사용 등록" / "원재료 사용 내역 수정"
- 모달 버튼 텍스트가 모드에 따라 변경: "등록" / "수정"

**스타일 추가:**
```css
.icon-btn-small { /* 작은 아이콘 버튼 */
    padding: 0.4rem;
    border-radius: var(--radius-sm);
    color: var(--text-muted);
    transition: all 0.2s;
    background: transparent;
}

.icon-btn-small:hover { /* 호버 시 보라색 배경 */
    background: #e0e7ff;
    color: var(--primary);
}

.delete-btn-small:hover { /* 삭제 버튼 호버 시 빨간색 */
    background: #fee2e2;
    color: var(--danger);
}
```

## 사용 방법

### 원재료 사용 내역 수정

1. 원재료관리 페이지 하단의 "최근 원재료 사용 내역" 테이블에서 수정할 행 찾기
2. 해당 행의 "작업" 컬럼에서 **연필 아이콘** (수정) 클릭
3. 모달이 열리며 기존 데이터가 자동으로 채워짐
4. 수정할 내용 변경 (수량, 작업지시번호, 날짜, 비고 등)
5. **"수정"** 버튼 클릭
6. ✅ 수정 완료 알림 표시 + 재고 자동 조정

**예시:**
- 기존: 플라스틱 50kg 사용 (재고 100kg → 50kg)
- 수정: 30kg로 변경
- 결과: 재고 50kg → 70kg로 증가 (20kg 반환)

### 원재료 사용 내역 삭제

1. 사용 내역 테이블에서 삭제할 행 찾기
2. **휴지통 아이콘** (삭제) 클릭
3. 확인 메시지에서 **확인** 클릭
   - 메시지: "'플라스틱' 사용 내역을 삭제하시겠습니까? 삭제 시 재고가 50kg 증가합니다."
4. ✅ 삭제 완료 알림 표시 + 재고 자동 복원

**예시:**
- 기존: 플라스틱 50kg 사용 기록 (재고 50kg)
- 삭제 후: 재고 50kg → 100kg로 복원

## 입출고 관리 수정/삭제

**입출고 관리는 이미 수정/삭제 기능이 구현되어 있습니다!**

1. 입출고관리 페이지에서 거래 내역 확인
2. 각 행의 "작업" 컬럼에서:
   - **연필 아이콘** - 수정
   - **휴지통 아이콘** - 삭제
3. 수정/삭제 가능

## 주의사항

⚠️ **재고 무결성**
- 수정/삭제 시 재고가 자동으로 조정됩니다
- 잘못된 수정은 재고 불일치를 초래할 수 있으니 신중하게 사용하세요
- 가능하면 삭제보다는 수정을 권장합니다

⚠️ **삭제는 영구적입니다**
- 삭제된 데이터는 복구할 수 없습니다
- 삭제 전 반드시 확인하세요

## 테스트 방법

1. 원재료관리 페이지에서 자재 사용 등록
2. 하단 테이블에서 방금 등록한 내역 확인
3. 수정 버튼 클릭하여 수량 변경
4. 자재 테이블에서 재고가 올바르게 조정되었는지 확인
5. 삭제 버튼 클릭하여 내역 삭제
6. 재고가 복원되었는지 확인

---

✅ **완료!** 이제 원재료관리와 입출고관리 모두에서 오기재된 데이터를 수정/삭제할 수 있습니다!
